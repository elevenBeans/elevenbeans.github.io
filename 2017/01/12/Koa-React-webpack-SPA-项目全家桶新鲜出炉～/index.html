<!DOCTYPE html>
<html lang="">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">
<meta name="baidu-site-verification" content="HTOBD3Guy9" />

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="SPA 项目全家桶新鲜出炉（Koa+React+webpack） ～"/>




  <meta name="keywords" content="React,Koa," />





  <link rel="alternate" href="/default" title="Elevenbeans">




  <link rel="shortcut icon" type="image/x-icon" href="/elevenbeans.ico?v=1.1" />



<link rel="canonical" href="http://yoursite.com/2017/01/12/Koa-React-webpack-SPA-项目全家桶新鲜出炉～/"/>


<meta name="description" content="来豚厂还不满半年就又一次被 “拥抱变化”。
不过，无论是之前的无线 H5 团队，还是现在的机票 H5 团队。始终维持着一个创业型团队的规模 （一只手数得清）。
新老板提到：机票 H5 team 作为一个小团队，会类似“小白鼠”的角色，需要快速迭代、敏捷开发，作为创新项目的试验田。
对于我个人来讲，最深刻的，其实是无尽的危机感。
跟在阿里的师兄从 React 的易用性，讨论到前端新技术技术迭代升级的">
<meta property="og:type" content="article">
<meta property="og:title" content="SPA 项目全家桶新鲜出炉（Koa+React+webpack） ～">
<meta property="og:url" content="http://yoursite.com/2017/01/12/Koa-React-webpack-SPA-项目全家桶新鲜出炉～/index.html">
<meta property="og:site_name" content="Elevenbeans">
<meta property="og:description" content="来豚厂还不满半年就又一次被 “拥抱变化”。
不过，无论是之前的无线 H5 团队，还是现在的机票 H5 团队。始终维持着一个创业型团队的规模 （一只手数得清）。
新老板提到：机票 H5 team 作为一个小团队，会类似“小白鼠”的角色，需要快速迭代、敏捷开发，作为创新项目的试验田。
对于我个人来讲，最深刻的，其实是无尽的危机感。
跟在阿里的师兄从 React 的易用性，讨论到前端新技术技术迭代升级的">
<meta property="og:updated_time" content="2018-03-25T06:55:55.890Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SPA 项目全家桶新鲜出炉（Koa+React+webpack） ～">
<meta name="twitter:description" content="来豚厂还不满半年就又一次被 “拥抱变化”。
不过，无论是之前的无线 H5 团队，还是现在的机票 H5 团队。始终维持着一个创业型团队的规模 （一只手数得清）。
新老板提到：机票 H5 team 作为一个小团队，会类似“小白鼠”的角色，需要快速迭代、敏捷开发，作为创新项目的试验田。
对于我个人来讲，最深刻的，其实是无尽的危机感。
跟在阿里的师兄从 React 的易用性，讨论到前端新技术技术迭代升级的">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>






<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  

  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-100591386-1', 'auto');
        ga('send', 'pageview');
  </script>



    <title> SPA 项目全家桶新鲜出炉（Koa+React+webpack） ～ - Elevenbeans </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">
          <img width="58px" src="https://raw.githubusercontent.com/elevenBeans/Grocery/master/elevenbeans-black.png"/>
          Elevenbeans
        </a>
    </h1>
    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/">
                            
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
    </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          SPA 项目全家桶新鲜出炉（Koa+React+webpack） ～
        
      </h1>

      <time class="post-time">
          Jan 12 2017
      </time>
    </header>

    
            <div class="post-content">
            <script src="/assets/js/APlayer.min.js"> </script><p>来豚厂还不满半年就又一次被 “拥抱变化”。</p>
<p>不过，无论是之前的无线 H5 团队，还是现在的机票 H5 团队。始终维持着一个创业型团队的规模 （一只手数得清）。</p>
<p>新老板提到：机票 H5 team 作为一个小团队，会类似“小白鼠”的角色，需要快速迭代、敏捷开发，作为创新项目的试验田。</p>
<p>对于我个人来讲，最深刻的，其实是无尽的危机感。</p>
<p>跟在阿里的师兄从 React 的易用性，讨论到前端新技术技术迭代升级的意义，最后总结到到一切技术都是辣鸡，升级说的直白一点就是换一种砖继续搬。深感无奈～</p>
<p>一线的开发是资源、是螺丝钉，没毛病。</p>
<p>先做一颗万能螺丝钉行不行？</p>
<p>抑或说，假如现在有机会让我一个初创公司的技术 leader， 我应该做到什么呢？</p>
<p>想太多不幸福，不如直接干～</p>
<a id="more"></a>
<h2 id="THE-WAY-TO-FULL-STACK"><a href="#THE-WAY-TO-FULL-STACK" class="headerlink" title="THE WAY TO FULL STACK"></a>THE WAY TO FULL STACK</h2><p>SPA 项目全家桶新鲜出炉： <strong>Node + Koa + React</strong> <a href="https://github.com/elevenBeans/TW2FS" target="_blank" rel="external">View on github</a></p>
<h3 id="后端框架-Koa"><a href="#后端框架-Koa" class="headerlink" title="后端框架 Koa"></a>后端框架 <a href="http://koa.rednode.cn/" target="_blank" rel="external">Koa</a></h3><p><em>由 Express 原班人马打造的 koa,仅提供了一个轻量优雅的函数库，使得编写 Web 应用变得得心应手。</em></p>
<ul>
<li><p>使用Koa 框架搭建后端服务，作为 SPA 的入口和容器。</p>
</li>
<li><p>使用单一职责的 Koa-Router，配合前端 React-router。处理外部直接 Landing、原地重刷新以及区分 404 页面:</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><code><div class="line"><span class="keyword">var</span> ThrowToHomePage = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params">ctx, next</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'EVR in router:'</span>,process.env.NODE_ENV);</div><div class="line">  ctx.state = &#123;</div><div class="line">    <span class="attr">env</span>: process.env.NODE_ENV,</div><div class="line">    <span class="attr">cdnUrl</span>: CDN_URL</div><div class="line">  &#125;;</div><div class="line">  <span class="keyword">await</span> ctx.render(<span class="string">'index'</span>, &#123; <span class="comment">//去前端根路由</span></div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> ThrowToErroPage = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params">ctx, next</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'EVR in router:'</span>,process.env.NODE_ENV);</div><div class="line">  ctx.state = &#123;</div><div class="line">  	<span class="attr">env</span>: process.env.NODE_ENV,</div><div class="line">    <span class="attr">cdnUrl</span>: CDN_URL,</div><div class="line">    <span class="attr">message</span>: <span class="string">'error'</span>,</div><div class="line">    <span class="attr">error</span>: &#123;<span class="attr">status</span>:<span class="number">404</span>,<span class="attr">stack</span>:<span class="string">'stack:'</span>&#125;</div><div class="line">  &#125;;</div><div class="line">  <span class="keyword">await</span> ctx.render(<span class="string">'error'</span>, &#123; <span class="comment">//去 404</span></div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">router.get(<span class="string">'/'</span>, ThrowToHomePage);</div><div class="line">router.get(<span class="string">'flight'</span>, ThrowToHomePage);</div><div class="line">router.get(<span class="string">'hotel'</span>, ThrowToHomePage);</div><div class="line">router.get(<span class="string">'train'</span>, ThrowToHomePage);</div><div class="line"></div><div class="line">router.get(<span class="string">'*'</span>, ThrowToErroPage);</div></code></pre></td></tr></table></figure>
<ul>
<li>使用 ejs 模版引擎作为主应用的后端唯一 View:</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><code><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">%-</span> <span class="attr">include</span>('<span class="attr">header</span>') <span class="attr">-</span>%&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">'app'</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">%-</span> <span class="attr">include</span>('<span class="attr">footer</span>') <span class="attr">-</span>%&gt;</span></div></code></pre></td></tr></table></figure>
<h3 id="前端相关技术架构"><a href="#前端相关技术架构" class="headerlink" title="前端相关技术架构"></a>前端相关技术架构</h3><ul>
<li>使用日趋成熟的 JS 语言标准 ES6， 使用 Less 预处理语言: <a href="https://github.com/elevenBeans/TW2FS/blob/master/public/javascripts/home/index.jsx" target="_blank" rel="external">示例代码</a></li>
<li>使用 React + ReactDOM 进行框架前端组件化开发</li>
<li>React-Router：<strong>SPA 的核心</strong>，与后端路由配合完成应用 Router</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><code><div class="line"><span class="tag">&lt;<span class="name">Router</span> <span class="attr">key</span>=<span class="string">&#123;Math.random()&#125;</span> <span class="attr">history</span>=<span class="string">&#123;browserHistory&#125;</span> &gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"/"</span> <span class="attr">component</span>=<span class="string">&#123;App&#125;</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">IndexRoute</span> <span class="attr">component</span>=<span class="string">&#123;Home&#125;/</span>&gt;</span></div><div class="line"></div><div class="line">       <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"flight"</span> <span class="attr">component</span>=<span class="string">&#123;Flight&#125;</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line"></div><div class="line">       <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"flight/:citys"</span> <span class="attr">component</span>=<span class="string">&#123;FlightList&#125;</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line"></div><div class="line">       <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"train"</span> <span class="attr">component</span>=<span class="string">&#123;Train&#125;</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line"></div><div class="line">       <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"hotel"</span> <span class="attr">component</span>=<span class="string">&#123;Hotel&#125;</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line">     <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line">   <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></div></code></pre></td></tr></table></figure>
<ul>
<li>模块化：ES6 module</li>
<li>转场过渡效果：React-router-transition，作为一个 SPA，就是要做到如丝般顺滑～</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><code><div class="line"><span class="keyword">var</span> App = <span class="function"><span class="keyword">function</span> (<span class="params">&#123; children, location &#125;</span>) </span>&#123; <span class="comment">//children = React.children</span></div><div class="line">  styles = location.action === <span class="string">'POP'</span>? presets.slideRight: presets.slideLeft;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">Header</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">RouteTransition</span></span></div><div class="line">      <span class="attr">className</span>=<span class="string">"transition-wrapper"</span></div><div class="line">      <span class="attr">pathname</span>=<span class="string">&#123;location.pathname&#125;</span></div><div class="line">      <span class="attr">runOnMount</span>=<span class="string">&#123;false&#125;</span></div><div class="line">      &#123;<span class="attr">...styles</span>&#125;&gt;</div><div class="line">      &#123;children&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">RouteTransition</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  )</div><div class="line">&#125;</div></code></pre></td></tr></table></figure>
<h3 id="编译构建：Webpack-Babel"><a href="#编译构建：Webpack-Babel" class="headerlink" title="编译构建：Webpack + Babel"></a>编译构建：Webpack + Babel</h3><p>Webpack 简直就是为了 SPA 和 ES6 量身打造的打包工具 ！！！<br>对于 webpack.config.js 的配置：</p>
<ul>
<li>库文件 external</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><code><div class="line">externals: &#123;</div><div class="line">  <span class="string">'zepto'</span>: <span class="string">'window.$'</span>,</div><div class="line">  <span class="string">'react'</span>:<span class="string">'window.React'</span>,</div><div class="line">  <span class="string">'react-dom'</span>:<span class="string">'window.ReactDOM'</span></div><div class="line">&#125;,</div></code></pre></td></tr></table></figure>
<p>像是 Jquery、zepto、React 这种官方已有编译好库文件的，直接挂载到全局对象引用即可。没有必要再通过 webpack 的流程在编译一次。</p>
<ul>
<li>公共组件 CommonsChunkPlugin</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><code><div class="line">entry: &#123;</div><div class="line">  <span class="attr">router</span>: [<span class="string">'react-router'</span>] <span class="comment">// CommonsChunkPlugin</span></div><div class="line">&#125;,  </div><div class="line"><span class="attr">plugins</span>:  [</div><div class="line">  <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(<span class="string">'router'</span>,<span class="string">'[name].bundle.js'</span>)<span class="comment">// CommonsChunk</span></div><div class="line">]</div></code></pre></td></tr></table></figure>
<p>  对于 React-router 这种非官方的插件，最好还是下载 stable 版本的源码，自行编译。</p>
<ul>
<li>样式文件单独打包</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line"><span class="keyword">new</span> ExtractTextPlugin(<span class="string">"./css/IBU.H5.flight.css"</span>)</div></code></pre></td></tr></table></figure>
<ul>
<li><strong>Hot Module Replacement</strong></li>
</ul>
<p><strong>狂!!! 拽!!! 酷炫!!! 吊炸天!!! 的新功能</strong>，详情请戳 –&gt;<a href="http://webpack.github.io/docs/hot-module-replacement-with-webpack.html#tutorial" target="_blank" rel="external">tutorial</a>。</p>
<p>据说可以在生产环境中使用，但是官方承认还不稳定. 耿直！<a href="http://webpack.github.io/docs/hot-module-replacement-with-webpack.html#caveats" target="_blank" rel="external">请戳戳</a></p>
<p>官方的才是可信赖的，嗯。</p>
<h3 id="结束也不是结束"><a href="#结束也不是结束" class="headerlink" title="结束也不是结束"></a>结束也不是结束</h3><p>写到这里，总觉得还少点什么？</p>
<p>这样就可以开始全栈开发 SPA 了？</p>
<p>前端有了，后端也有了。数据呢？</p>
<p><a href="http://elevenbeans.github.io/2016/05/31/node-mysql-CRUD/" target="_blank" rel="external">刀耕火种之 Node 直接查 DB</a></p>
<p>真正成为一个专业的后端乃至全栈开发人员，任重而道远。</p>

            </div>
          
    
      <footer class="post-footer">
        <div class="post-tags">
          
          
          
            <a href="/tags/React/">React</a>
          
            <a href="/tags/Koa/">Koa</a>
          
          

        </div>
       
         
         
  <nav class="post-nav">
    
      <a class="prev" href="/2017/01/22/常用算法汇总/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">常用算法汇总</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2016/10/24/1024/">
        <span class="next-text nav-default">1024</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

         
  <div class="comments" id="comments">
    
    <div id="comment-container"></div>
  </div>


       
      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2014 -
    
    2018
    <span class="footer-author"><a href="https://github.com/elevenbeans" target="_blank">@elevenbeans</a>.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>
    </span>

</span>
<script>
var gitment = new Gitment({
  id: location.pathname, // 可选。默认为 location.href
  owner: 'elevenbeans',
  repo: 'elevenbeans.github.io',
  oauth: {
    client_id: '34a6c343407ce5dcf922',
    client_secret: '9669a9498f09f3b21711bd666a50db5929e78256',
  },
})
gitment.render('comment-container')
</script>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
