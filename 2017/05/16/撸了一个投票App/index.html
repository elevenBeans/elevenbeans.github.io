<!DOCTYPE html>
<html lang="">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">
<meta name="baidu-site-verification" content="HTOBD3Guy9" />

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="全栈开发实例：如何独立开发/发布一个 WebAPP"/>




  <meta name="keywords" content="全栈开发,webApp,投票," />





  <link rel="alternate" href="/default" title="Elevenbeans">




  <link rel="shortcut icon" type="image/x-icon" href="/elevenbeans.ico?v=1.1" />



<link rel="canonical" href="http://yoursite.com/2017/05/16/撸了一个投票App/"/>


<meta name="description" content="talkIsCheap( )？goto(lastParagraph):continue( )
背景全栈工程师，也叫全端工程师(同时具备前端和后台能力)，英文 Full Stack developer。是指掌握多种技能，并能利用多种技能独立完成产品的人.  （From 百度）
敲黑板：利用多种技能独立完成产品。
So, 至少需要一个人 cover 掉 前端 + 后端 + 数据库吧 ～
搞一个活生生">
<meta property="og:type" content="article">
<meta property="og:title" content="全栈开发实例：如何独立开发/发布一个 WebAPP">
<meta property="og:url" content="http://yoursite.com/2017/05/16/撸了一个投票App/index.html">
<meta property="og:site_name" content="Elevenbeans">
<meta property="og:description" content="talkIsCheap( )？goto(lastParagraph):continue( )
背景全栈工程师，也叫全端工程师(同时具备前端和后台能力)，英文 Full Stack developer。是指掌握多种技能，并能利用多种技能独立完成产品的人.  （From 百度）
敲黑板：利用多种技能独立完成产品。
So, 至少需要一个人 cover 掉 前端 + 后端 + 数据库吧 ～
搞一个活生生">
<meta property="og:image" content="https://raw.githubusercontent.com/elevenBeans/Grocery/master/voteApp.png">
<meta property="og:updated_time" content="2018-03-25T06:55:25.350Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="全栈开发实例：如何独立开发/发布一个 WebAPP">
<meta name="twitter:description" content="talkIsCheap( )？goto(lastParagraph):continue( )
背景全栈工程师，也叫全端工程师(同时具备前端和后台能力)，英文 Full Stack developer。是指掌握多种技能，并能利用多种技能独立完成产品的人.  （From 百度）
敲黑板：利用多种技能独立完成产品。
So, 至少需要一个人 cover 掉 前端 + 后端 + 数据库吧 ～
搞一个活生生">
<meta name="twitter:image" content="https://raw.githubusercontent.com/elevenBeans/Grocery/master/voteApp.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>






<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  

  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-100591386-1', 'auto');
        ga('send', 'pageview');
  </script>



    <title> 全栈开发实例：如何独立开发/发布一个 WebAPP - Elevenbeans </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">
          <img width="58px" src="https://raw.githubusercontent.com/elevenBeans/Grocery/master/elevenbeans-black.png"/>
          Elevenbeans
        </a>
    </h1>
    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/">
                            
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
    </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          全栈开发实例：如何独立开发/发布一个 WebAPP
        
      </h1>

      <time class="post-time">
          May 16 2017
      </time>
    </header>

    
            <div class="post-content">
            <script src="/assets/js/APlayer.min.js"> </script><p><code>talkIsCheap( )？goto(lastParagraph):continue( )</code></p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p><em>全栈工程师，也叫全端工程师(同时具备前端和后台能力)，英文 Full Stack developer。是指掌握多种技能，并能利用多种技能独立完成产品的人.</em>  （From 百度）</p>
<p>敲黑板：<strong>利用多种技能独立完成产品</strong>。</p>
<p>So, 至少需要一个人 cover 掉 前端 + 后端 + 数据库吧 ～</p>
<p>搞一个活生生的投票应用送给各位 : ) 具体功能为：</p>
<ul>
<li><p>对于已经授权用户可以：</p>
<ul>
<li>新建一个 poll，可自定义其中的选项</li>
<li>存储发起的 polls，下次登陆仍旧可以看到自己发起的 polls 集合</li>
<li>看到应用中所有用户创建的 polls 的实时投票结果 （用图表展示）</li>
<li>向所有 polls 投票（每个 poll 每个用户号只能投一票）.</li>
<li>可分享 poll (poll 详情页支持外部 landing)</li>
</ul>
</li>
<li><p>非授权用户只能：</p>
<ul>
<li>看到应用中所有用户创建的 polls 的实时投票结果 （用图表展示）</li>
</ul>
</li>
</ul>
<h2 id="开发过程"><a href="#开发过程" class="headerlink" title="开发过程"></a>开发过程</h2><p><strong>整体技术目标：React + Express + Mongodb 完成一个投票 SPA</strong></p>
<h3 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h3><ul>
<li>概述<ul>
<li>使用 JS 语言标准 <a href="http://www.nodeclass.com/api/ECMAScript6.html" target="_blank" rel="external">ES6</a></li>
<li>模块化：ES6 module</li>
<li>使用 React + ReactDOM 进行框架前端组件化开发</li>
<li>React-Router：SPA 的核心，与后端路由配合完成应用路由</li>
<li>React-router-transition：转场过渡效果就是要做到如丝般顺滑～</li>
</ul>
</li>
<li><p>前端入口 <a href="https://github.com/elevenBeans/WeVoting/blob/master/client/index.jsx#L25" target="_blank" rel="external">(View source)</a></p>
<p>利用 React router 将首页指向 Home 组件，定义三个新路由 list、detail、new，分别指向对应页面组件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><code><div class="line"><span class="tag">&lt;<span class="name">Router</span> <span class="attr">key</span>=<span class="string">&#123;Math.random()&#125;</span> <span class="attr">history</span>=<span class="string">&#123;browserHistory&#125;</span> &gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"/"</span> <span class="attr">component</span>=<span class="string">&#123;App&#125;</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">IndexRoute</span> <span class="attr">component</span>=<span class="string">&#123;Home&#125;/</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"/list(/:name)"</span> <span class="attr">component</span>=<span class="string">&#123;List&#125;</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"/detail(/:id)"</span> <span class="attr">component</span>=<span class="string">&#123;Detail&#125;</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"/new"</span> <span class="attr">component</span>=<span class="string">&#123;New&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">Router</span>&gt;</span></div></code></pre></td></tr></table></figure>
</li>
<li><p>页面级组件<br>每一个页面级组件对应一个应用页面，均继承自 <code>React.Component</code></p>
<ul>
<li>home <a href="https://github.com/elevenBeans/WeVoting/blob/master/client/home.jsx" target="_blank" rel="external">(View source)</a><ul>
<li>作为应用的首页, 列出应用主要功能和信息</li>
<li>对应 router: <code>/</code></li>
</ul>
</li>
<li>list <a href="https://github.com/elevenBeans/WeVoting/blob/master/client/list.jsx" target="_blank" rel="external">(View source)</a><ul>
<li>列表页展示所有 polls 及对应 title、owner 等概要信息</li>
<li>对应 router: <code>/list(/:name)</code></li>
</ul>
</li>
<li>detail <a href="https://github.com/elevenBeans/WeVoting/blob/master/client/detail.jsx" target="_blank" rel="external">(View source)</a><ul>
<li>详情页展示指定 poll 的详细信息</li>
<li>对应 router: <code>/detail(/:id)</code></li>
</ul>
</li>
<li>new <a href="https://github.com/elevenBeans/WeVoting/blob/master/client/new.jsx" target="_blank" rel="external">(View source)</a><ul>
<li>新建页收集新建 poll 的必要信息</li>
<li>对应 router: <code>/new</code></li>
</ul>
</li>
</ul>
</li>
<li><p>公共组件</p>
<ul>
<li>header <a href="https://github.com/elevenBeans/WeVoting/blob/master/client/components/header.jsx" target="_blank" rel="external">(View source)</a>: 所有页面的共同头部，包含个性化 menu、用户头像姓名，登入登出按钮等等</li>
<li>footer <a href="https://github.com/elevenBeans/WeVoting/blob/master/client/components/footer.jsx" target="_blank" rel="external">(View source)</a>: 可复用的页面底部，包含 copyright 信息</li>
<li>loading: 加载动效 （推荐一个工具 <a href="https://loading.io/" target="_blank" rel="external">loading.io</a>）</li>
<li>spning: 按钮等待动效</li>
</ul>
</li>
<li>异步请求<ul>
<li><a href="http://www.phperz.com/article/15/0813/148111.html#$.ajax" target="_blank" rel="external">zepto ajax</a> (均采用 POST, 整站开发, 不跨域)</li>
</ul>
</li>
</ul>
<h3 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h3><ul>
<li>概述<ul>
<li>使用 Express 框架搭建后端服务，作为 SPA 的入口和容器。</li>
<li>使用单一职责的 <code>express.Router()</code>，配合前端 React-router。处理外部直接 Landing、原地重刷新以及区分 404 页面:</li>
<li>使用 ejs 模版引擎作为主应用的后端 View:</li>
</ul>
</li>
<li>Views<ul>
<li>index <a href="https://github.com/elevenBeans/WeVoting/blob/master/views/index.ejs" target="_blank" rel="external">(View source)</a>: 后端入口模版，提供 <code>React.reader()</code> 的目标 DOM 节点</li>
<li>header <a href="https://github.com/elevenBeans/WeVoting/blob/master/views/header.ejs" target="_blank" rel="external">(View source)</a>: 模版公共头部：HTML 的 <code>&lt;head&gt;</code> 信息，以及在其中需要同步加载的 js、css 资源</li>
<li>footer <a href="https://github.com/elevenBeans/WeVoting/blob/master/views/footer.ejs" target="_blank" rel="external">(View source)</a>: 模版公共尾部： 主要用于加载 HTML 尾部 js 资源</li>
<li>error <a href="https://github.com/elevenBeans/WeVoting/blob/master/views/error.ejs" target="_blank" rel="external">(View source)</a>: 错误页模版</li>
</ul>
</li>
<li><p>Views Router <a href="https://github.com/elevenBeans/WeVoting/blob/master/controller/routes/view.js" target="_blank" rel="external">(View source)</a></p>
<p>所有 Landing 或者页面刷新的链接都由后端同一收口到 views 中的 index，再由前端统一处理。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><code><div class="line">router.get(<span class="string">'/detail/:id'</span>, throwToHome);</div><div class="line">router.get(<span class="string">'/detail'</span>, throwToHome);</div><div class="line">router.get(<span class="string">'/list/:name'</span>, throwToHome);</div><div class="line">router.get(<span class="string">'/list'</span>, throwToHome);</div><div class="line">router.get(<span class="string">'/new'</span>, throwToHome);</div><div class="line"></div><div class="line">router.get(<span class="string">'/'</span>, throwToHome);</div><div class="line">router.get(<span class="string">'*'</span>, throwToError);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">throwToHome</span>(<span class="params">request, response</span>)</span>&#123;</div><div class="line">  response.render(<span class="string">'index'</span>,</div><div class="line">  &#123;</div><div class="line">	<span class="attr">cdnUrl</span>: config.CDN_URL</div><div class="line">  &#125;</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">throwToError</span>(<span class="params">request, response</span>)</span>&#123;</div><div class="line">  response.render(<span class="string">'error'</span>,</div><div class="line">  &#123;</div><div class="line">	<span class="attr">cdnUrl</span>: config.CDN_URL</div><div class="line">  &#125;</div><div class="line">  );</div><div class="line">&#125;</div></code></pre></td></tr></table></figure>
</li>
<li><p>第三方用户登陆</p>
<ul>
<li>选择 Github API，详细见 <a href="https://developer.github.com/v3/oauth/#web-application-flow" target="_blank" rel="external">Github OAuth - Web Application Flow</a>  </li>
</ul>
</li>
<li><p><strong>API</strong> <a href="https://github.com/elevenBeans/WeVoting/blob/master/controller/routes/api.js" target="_blank" rel="external">(View source)</a></p>
<ul>
<li><code>/getPollList</code>: 获取 polls 列表<ul>
<li>入参: <code>userName</code> (用户名)，可获取该用户创建的所有 polls; 缺省 <code>userName</code> 则获取所有存在的 polls</li>
<li>返回: 符合条件的 polls 列表</li>
</ul>
</li>
<li><code>/getPollByID</code>: 获取指定的 poll 的详细信息<ul>
<li>入参: <code>pollID</code> (poll 唯一标识)</li>
<li>返回: 一个包含指定 poll 的单元素列表</li>
</ul>
</li>
<li><code>/upDatePollByID</code>: 更新一个 poll (投票)<ul>
<li>入参 <code>pollID</code>  (poll 唯一标识); <code>index</code>（用户具体投给的选项编号）; <code>voter</code>（传递投票的用户名，避免用户对同一个 poll 多次投票)</li>
<li>返回 <code>result</code>: <code>bool</code> 类型值，告诉你是否更新成功</li>
</ul>
</li>
<li><code>/insertPoll</code>: 新建一个 poll<ul>
<li>入参<code>title</code>(poll 题目),<code>description</code>(poll 描述),<code>options</code>: (poll 中的选项),<code>ownerName</code>(创建用户), <code>voterList</code>(投票用户，初始为空数组)</li>
<li>返回 <code>result</code>: <code>bool</code> 类型值，告诉你是否创建成功</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><ul>
<li><p>Mongodb<br>MongoDB 是一个基于分布式文件存储的数据库。由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。MongoDB 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。</p>
</li>
<li><p>环境安装和配置</p>
<ul>
<li>下载：<a href="https://docs.mongodb.com/" target="_blank" rel="external">Download</a></li>
<li>安装：解压压缩文件至你任何想要存放的地方</li>
<li>配置：二进制文件可以直接执行, 配置你的 <code>.bashrc</code>文件：<code>export PATH=&lt;mongodb-install-directory&gt;/bin:$PATH</code>, 例如我的是 <code>export PATH=$HOME/mongodb/bin:$PATH</code></li>
<li><p>运行 mongodb 服务, 默认 27017 端口</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">mongod</div></code></pre></td></tr></table></figure>
</li>
<li><p>运行 Cli， 用命令行对于数据库的常用操作</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">mongo // 进入 Cli</div></code></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">show dbs // 显示所有数据库</div></code></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">use &lt;dbName&gt; // 进入指定数据库</div></code></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">show collections // 显示所有 collections (table)</div></code></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">db.&lt;collectionName&gt;.find(&#123;&#125;) // 查询</div></code></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">db.&lt;collectionName&gt;.deleteOne(&#123;&#125;) // 删除</div></code></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Express 连接 Mongodb <a href="https://github.com/elevenBeans/WeVoting/blob/master/controller/DBhandler.js" target="_blank" rel="external">(View source)</a>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><code><div class="line"><span class="keyword">var</span> dbUrl = <span class="string">'mongodb://localhost:27017/voting'</span></div><div class="line"><span class="keyword">var</span> mongo = <span class="built_in">require</span>(<span class="string">"mongodb"</span>).MongoClient;</div><div class="line">mongo.connect(dbUrl, <span class="function"><span class="keyword">function</span>(<span class="params">err, db</span>)</span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> pullList = db.collection(<span class="string">'pollList'</span>);</div><div class="line">  pullList.find(&#123;<span class="attr">ownerName</span>: ownerName&#125;,&#123;&#125;).sort(&#123;<span class="attr">timestamp</span>: <span class="number">-1</span>&#125;).toArray(<span class="function"><span class="keyword">function</span>(<span class="params">err, docs</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(err)&#123;</div><div class="line">  	db.close();</div><div class="line">  	errCal(err);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">  	db.close();</div><div class="line">  	sucCal(docs);</div><div class="line">  &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></code></pre></td></tr></table></figure>
</li>
<li><p>数据库 collection (table) 设计</p>
</li>
</ul>
<p>userList schema:<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><code><div class="line">&#123;</div><div class="line">    <span class="attr">"type"</span>: <span class="string">"array"</span>,</div><div class="line">    <span class="attr">"items"</span>: &#123;</div><div class="line">        <span class="attr">"type"</span>: <span class="string">"object"</span>,</div><div class="line">        <span class="attr">"properties"</span>: &#123;</div><div class="line">            <span class="attr">"_id"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"integer"</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">"email"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"string"</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">"name"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"string"</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">"timestamp"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"integer"</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></code></pre></td></tr></table></figure></p>
<p>pollList schema:<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><code><div class="line">&#123;</div><div class="line">    <span class="attr">"type"</span>: <span class="string">"array"</span>,</div><div class="line">    <span class="attr">"items"</span>: &#123;</div><div class="line">        <span class="attr">"type"</span>: <span class="string">"object"</span>,</div><div class="line">        <span class="attr">"properties"</span>: &#123;</div><div class="line">            <span class="attr">"_id"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"integer"</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">"description"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"string"</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">"options"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"array"</span>,</div><div class="line">                <span class="attr">"items"</span>: &#123;</div><div class="line">                    <span class="attr">"type"</span>: <span class="string">"object"</span>,</div><div class="line">                    <span class="attr">"properties"</span>: &#123;</div><div class="line">                        <span class="attr">"count"</span>: &#123;</div><div class="line">                            <span class="attr">"type"</span>: <span class="string">"integer"</span></div><div class="line">                        &#125;,</div><div class="line">                        <span class="attr">"index"</span>: &#123;</div><div class="line">                            <span class="attr">"type"</span>: <span class="string">"integer"</span></div><div class="line">                        &#125;,</div><div class="line">                        <span class="attr">"option"</span>: &#123;</div><div class="line">                            <span class="attr">"type"</span>: <span class="string">"string"</span></div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">"ownerName"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"string"</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">"pollID"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"string"</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">"title"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"string"</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">"voterList"</span>: &#123;</div><div class="line">                <span class="attr">"type"</span>: <span class="string">"array"</span>,</div><div class="line">                <span class="attr">"items"</span>: &#123;</div><div class="line">                    <span class="attr">"type"</span>: <span class="string">"string"</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></code></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="发布过程"><a href="#发布过程" class="headerlink" title="发布过程"></a>发布过程</h2><h3 id="heroku-发布代码至云服务"><a href="#heroku-发布代码至云服务" class="headerlink" title="heroku 发布代码至云服务"></a>heroku 发布代码至云服务</h3><p><a href="http://www.heroku.com/" target="_blank" rel="external">官网</a> (可能需要梯子)</p>
<ul>
<li>下载 Heroku Cli <a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#set-up" target="_blank" rel="external">Download</a></li>
<li><p>进入项目根目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">cd WeVoting</div></code></pre></td></tr></table></figure>
</li>
<li><p>执行 <code>heroku login</code> 进行登录，无账号则去官网申请</p>
</li>
<li><p>执行 <code>heroku create &lt;yourAppName&gt;</code> 创建 App，这里的<code>appName</code> 也是你在<code>herokuapp.com</code> 下的三级域名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">heroku create we-voting-ele</div></code></pre></td></tr></table></figure>
<p>  最终域名为：<a href="https://we-voting-ele.herokuapp.com" target="_blank" rel="external">https://we-voting-ele.herokuapp.com</a></p>
</li>
<li><p>推送代码到 heroku 进行发布</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">git push heroku master</div></code></pre></td></tr></table></figure>
</li>
<li><p>打开应用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">heroku open</div></code></pre></td></tr></table></figure>
</li>
<li><p>新建一个 Procfile 设置服务开启命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">web: node index.js</div></code></pre></td></tr></table></figure>
</li>
<li><p>Scale the app</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">heroku ps:scale web=1</div></code></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="heroku-addons-部署-mongodb-云服务-mLab-MongoDB"><a href="#heroku-addons-部署-mongodb-云服务-mLab-MongoDB" class="headerlink" title="heroku addons 部署 mongodb 云服务 mLab MongoDB"></a>heroku addons 部署 mongodb 云服务 <a href="https://elements.heroku.com/addons/mongolab" target="_blank" rel="external">mLab MongoDB</a></h3><ul>
<li><p>一行命令部署 mLab MongoDB 免费版</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">heroku addons:create mongolab:sandbox</div></code></pre></td></tr></table></figure>
</li>
<li><p>获取云数据库服务链接 <code>Mongodb_uri</code>, 用于后台代码连接 Mongodb 服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><code><div class="line">heroku config</div></code></pre></td></tr></table></figure>
</li>
</ul>
<p>详情请见：<a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#introduction" target="_blank" rel="external">Getting Started on Heroku with Node.js</a></p>
<p>Done ~</p>
<p><img src="https://raw.githubusercontent.com/elevenBeans/Grocery/master/voteApp.png" alt="img1"></p>
<h2 id="LISENCE"><a href="#LISENCE" class="headerlink" title="LISENCE"></a>LISENCE</h2><p>代码开源，<a href="http://www.ruanyifeng.com/blog/2011/05/how_to_choose_free_software_licenses.html" target="_blank" rel="external">一张图告诉你开源协议怎么选 by ryfeng</a></p>
<h2 id="最后送上源码和-Demo"><a href="#最后送上源码和-Demo" class="headerlink" title="最后送上源码和 Demo"></a>最后送上源码和 Demo</h2><p><a href="https://we-voting-ele.herokuapp.com/" target="_blank" rel="external">Demo 在此</a></p>
<p>看完了就去 <a href="https://github.com/elevenBeans/WeVoting" target="_blank" rel="external">Git repository</a> 加个星星吧 : )<br>能互相 follow 就更好了 ～</p>

            </div>
          
    
      <footer class="post-footer">
        <div class="post-tags">
          
          
          
            <span>#全栈开发# &nbsp;&nbsp;</span>
          
            <span>#webApp# &nbsp;&nbsp;</span>
          
            <span>#投票# &nbsp;&nbsp;</span>
          

        </div>
       
         
         
  <nav class="post-nav">
    
      <a class="prev" href="/2017/06/06/移动端浏览器调试方法汇总/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">移动端浏览器调试方法汇总</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2017/04/10/开源精神从我做起/">
        <span class="next-text nav-default">开源精神, 从我做起</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

         
  <div class="comments" id="comments">
    
    <div id="comment-container"></div>
  </div>


       
      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2014 -
    
    2018
    <span class="footer-author"><a href="https://github.com/elevenbeans" target="_blank">@elevenbeans</a>.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>
    </span>

</span>
<script>
var gitment = new Gitment({
  id: location.pathname, // 可选。默认为 location.href
  owner: 'elevenbeans',
  repo: 'elevenbeans.github.io',
  oauth: {
    client_id: '34a6c343407ce5dcf922',
    client_secret: '9669a9498f09f3b21711bd666a50db5929e78256',
  },
})
gitment.render('comment-container')
</script>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
